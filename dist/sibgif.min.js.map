{"version":3,"names":[],"mappings":"","sources":["sibgif.min.js"],"sourcesContent":["!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var t;t=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,t.SuperGif=e()}}(function(){var e;return function t(e,n,r){function a(o,s){if(!n[o]){if(!e[o]){var u=\"function\"==typeof require&&require;if(!s&&u)return u(o,!0);if(i)return i(o,!0);var l=new Error(\"Cannot find module '\"+o+\"'\");throw l.code=\"MODULE_NOT_FOUND\",l}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){var n=e[o][1][t];return a(n?n:t)},c,c.exports,t,e,n,r)}return n[o].exports}for(var i=\"function\"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){var r=function(e){this.data=e,this.len=this.data.length,this.pos=0,this.readByte=function(){if(this.pos>=this.data.length)throw new Error(\"Attempted to read past end of stream.\");return e instanceof Uint8Array?e[this.pos++]:255&e.charCodeAt(this.pos++)},this.readBytes=function(e){for(var t=[],n=0;n<e;n++)t.push(this.readByte());return t},this.read=function(e){for(var t=\"\",n=0;n<e;n++)t+=String.fromCharCode(this.readByte());return t},this.readUnsigned=function(){var e=this.readBytes(2);return(e[1]<<8)+e[0]}};t.exports=r},{}],2:[function(e,t,n){var r=function(e,t){var n,r,a=0,i=function(e){for(var n=0,r=0;r<e;r++)t[a>>3]&1<<(7&a)&&(n|=1<<r),a++;return n},o=1<<e,s=o+1,u=e+1,l=4096,c=4096,d=new Uint8Array(l),f=new Uint8Array(c),h=[],p=0,g=0,y=function(){for(var e=0;e<o;e++)h[e]=new Uint8Array(1),h[e][0]=e;h[o]=new Uint8Array(0),h[s]=null},v=function(){var t=o+2;h.splice(t,h.length-t),u=e+1,p=0},w=function(){var e=d.length+l,t=new Uint8Array(e);t.set(d),d=t,l<<=1},_=function(){var e=f.length+c,t=new Uint8Array(e);t.set(f),f=t,c<<=1},m=function(e,t){for(var n=h[t].byteLength+1;p+n>f.length;)_();var r=f.subarray(p,p+n);r.set(h[t]),r[n-1]=h[e][0],p+=n,h.push(r)};for(y();;)if(r=n,n=i(u),n!==o){if(n===s)break;if(n<h.length)r!==o&&m(n,r);else{if(n!==h.length)throw new Error(\"Invalid LZW code.\");m(r,r)}for(var x=h[n].length;g+x>d.length;)w();d.set(h[n],g),g+=x,h.length===1<<u&&u<12&&u++}else v();return d.subarray(0,g)};t.exports=r},{}],3:[function(e,t,n){var r=function(e){return e.reduce(function(e,t){return 2*e+t},0)},a=function(e){for(var t=[],n=7;n>=0;n--)t.push(!!(e&1<<n));return t},i=e(\"./lzwDecode.js\"),o=function(e,t){t||(t={});var n=function(t){for(var n=[],r=0;r<t;r++)n.push(e.readBytes(3));return n},o=function(){var t,n,r=0,a=8192;n=new Uint8Array(a);var i=function(){var e=new Uint8Array(n.length+a);e.set(n),n=e};do{for(t=e.readByte();r+t>n.length;)i();n.set(e.readBytes(t),r),r+=t}while(0!==t);return n.subarray(0,r)},s=function(){var i={};if(i.sig=e.read(3),i.ver=e.read(3),\"GIF\"!==i.sig)throw new Error(\"Not a GIF file.\");i.width=e.readUnsigned(),i.height=e.readUnsigned();var o=a(e.readByte());i.gctFlag=o.shift(),i.colorRes=r(o.splice(0,3)),i.sorted=o.shift(),i.gctSize=r(o.splice(0,3)),i.bgColor=e.readByte(),i.pixelAspectRatio=e.readByte(),i.gctFlag&&(i.gct=n(1<<i.gctSize+1)),t.hdr&&t.hdr(i)},u=function(n){var i=function(n){var i=(e.readByte(),a(e.readByte()));n.reserved=i.splice(0,3),n.disposalMethod=r(i.splice(0,3)),n.userInput=i.shift(),n.transparencyGiven=i.shift(),n.delayTime=e.readUnsigned(),n.transparencyIndex=e.readByte(),n.terminator=e.readByte(),t.gce&&t.gce(n)},s=function(e){e.comment=o(),t.com&&t.com(e)},u=function(n){e.readByte();n.ptHeader=e.readBytes(12),n.ptData=o(),t.pte&&t.pte(n)},l=function(n){var r=function(n){e.readByte();n.unknown=e.readByte(),n.iterations=e.readUnsigned(),n.terminator=e.readByte(),t.app&&t.app.NETSCAPE&&t.app.NETSCAPE(n)},a=function(e){e.appData=o(),t.app&&t.app[e.identifier]&&t.app[e.identifier](e)};e.readByte();switch(n.identifier=e.read(8),n.authCode=e.read(3),n.identifier){case\"NETSCAPE\":r(n);break;default:a(n)}},c=function(e){e.data=o(),t.unknown&&t.unknown(e)};switch(n.label=e.readByte(),n.label){case 249:n.extType=\"gce\",i(n);break;case 254:n.extType=\"com\",s(n);break;case 1:n.extType=\"pte\",u(n);break;case 255:n.extType=\"app\",l(n);break;default:n.extType=\"unknown\",c(n)}},l=function(s){var u=function(e,t){for(var n=new Array(e.length),r=e.length/t,a=function(r,a){var i=e.slice(a*t,(a+1)*t);n.splice.apply(n,[r*t,t].concat(i))},i=[0,4,2,1],o=[8,8,4,2],s=0,u=0;u<4;u++)for(var l=i[u];l<r;l+=o[u])a(l,s),s++;return n};s.leftPos=e.readUnsigned(),s.topPos=e.readUnsigned(),s.width=e.readUnsigned(),s.height=e.readUnsigned();var l=a(e.readByte());s.lctFlag=l.shift(),s.interlaced=l.shift(),s.sorted=l.shift(),s.reserved=l.splice(0,2),s.lctSize=r(l.splice(0,3)),s.lctFlag&&(s.lct=n(1<<s.lctSize+1)),s.lzwMinCodeSize=e.readByte();var c=o();s.pixels=i(s.lzwMinCodeSize,c),s.interlaced&&(s.pixels=u(s.pixels,s.width)),t.img&&t.img(s)},c=function(){var n={};switch(n.sentinel=e.readByte(),String.fromCharCode(n.sentinel)){case\"!\":n.type=\"ext\",u(n);break;case\",\":n.type=\"img\",l(n);break;case\";\":n.type=\"eof\",t.eof&&t.eof(n);break;default:throw new Error(\"Unknown block: 0x\"+n.sentinel.toString(16))}\"eof\"!==n.type&&setTimeout(c,0)},d=function(){s(),setTimeout(c,0)};d()};t.exports=o},{\"./lzwDecode.js\":2}],4:[function(t,n,r){!function(t,a){\"function\"==typeof e&&e.amd?e([],a):\"object\"==typeof r?n.exports=a():t.SuperGif=a()}(this,function(){if(\"object\"==typeof r)var e=t(\"./Stream.js\"),n=t(\"./parseGIF.js\");var a=function(t){var r={vp_l:0,vp_t:0,vp_w:null,vp_h:null,c_w:null,c_h:null};for(var a in t)r[a]=t[a];r.vp_w&&r.vp_h&&(r.is_vp=!0);var i,o,s=null,u=!1,l=null,c=null,d=null,f=null,h=null,p=null,g=null,y=!0,v=!0,w=!1,_=[],m=[],x=r.gif;\"undefined\"==typeof r.auto_play&&(r.auto_play=!x.getAttribute(\"data-autoplay\")||\"1\"==x.getAttribute(\"data-autoplay\"));var b,T,B,C,A=r.hasOwnProperty(\"on_end\")?r.on_end:null,U=r.hasOwnProperty(\"loop_delay\")?r.loop_delay:0,P=r.hasOwnProperty(\"loop_mode\")?r.loop_mode:\"auto\",S=!r.hasOwnProperty(\"draw_while_loading\")||r.draw_while_loading,k=!!S&&(!r.hasOwnProperty(\"show_progress_bar\")||r.show_progress_bar),E=r.hasOwnProperty(\"progressbar_height\")?r.progressbar_height:25,I=r.hasOwnProperty(\"progressbar_background_color\")?r.progressbar_background_color:\"rgba(255,255,255,0.4)\",D=r.hasOwnProperty(\"progressbar_foreground_color\")?r.progressbar_foreground_color:\"rgba(255,0,22,.8)\",j=function(){l=null,c=null,h=d,d=null,p=null},O=function(){return{hdr:Z(M),gce:Z(L),com:Z(X),app:{NETSCAPE:Z(X)},img:Z(W,!0),eof:function(e){q(),V(!1),r.c_w&&r.c_h||(b.width=o.width*K(),b.height=o.height*K()),H.init(),u=!1,Y&&Y(s,x)}}},R=function(){try{n(i,O())}catch(e){G(\"parse\")}},z=function(e,t){b.width=e*K(),b.height=t*K(),B.style.minWidth=e*K()+\"px\",C.width=e,C.height=t,C.style.width=e+\"px\",C.style.height=t+\"px\",C.getContext(\"2d\").setTransform(1,0,0,1,0,0)},F=function(e,t){return m[e]?(\"undefined\"!=typeof t.x&&(m[e].x=t.x),void(\"undefined\"!=typeof t.y&&(m[e].y=t.y))):void(m[e]=t)},N=function(e,t,n){if(n&&k){var a,i,o,s,u=E;r.is_vp?w?(o=(r.vp_t+r.vp_h-u)/K(),u/=K(),a=r.vp_l/K(),i=a+e/t*(r.vp_w/K()),s=b.width/K()):(o=r.vp_t+r.vp_h-u,u=u,a=r.vp_l,i=a+e/t*r.vp_w,s=b.width):(o=(b.height-u)/(w?K():1),i=e/t*b.width/(w?K():1),s=b.width/(w?K():1),u/=w?K():1),T.fillStyle=I,T.fillRect(i,o,s-i,u),T.fillStyle=D,T.fillRect(0,o,i,u)}},G=function(e){var t=function(){T.fillStyle=\"black\",T.fillRect(0,0,r.c_w?r.c_w:o.width,r.c_h?r.c_h:o.height),T.strokeStyle=\"red\",T.lineWidth=3,T.moveTo(0,0),T.lineTo(r.c_w?r.c_w:o.width,r.c_h?r.c_h:o.height),T.moveTo(0,r.c_h?r.c_h:o.height),T.lineTo(r.c_w?r.c_w:o.width,0),T.stroke()};s=e,o={width:x.width,height:x.height},_=[],t()},M=function(e){o=e,z(o.width,o.height)},L=function(e){q(),j(),l=e.transparencyGiven?e.transparencyIndex:null,c=e.delayTime,d=e.disposalMethod},q=function(){if(p){var e={data:p.getImageData(0,0,o.width,o.height),delay:c};r.includeDataURL&&(e.dataURL=C.toDataURL()),_.push(e),m.push({x:0,y:0})}},W=function(e){p||(p=C.getContext(\"2d\"));var t=_.length,n=e.lctFlag?e.lct:o.gct;t>0&&(3===h?null!==f?p.putImageData(_[f].data,0,0):p.clearRect(g.leftPos,g.topPos,g.width,g.height):f=t-1,2===h&&p.clearRect(g.leftPos,g.topPos,g.width,g.height));for(var a=p.getImageData(e.leftPos,e.topPos,e.width,e.height),i=0;i<e.pixels.length;i++){var s=e.pixels[i];if(s!==l){var u=n[s],c=4*i;a.data[c]=u[0],a.data[c+1]=u[1],a.data[c+2]=u[2],a.data[c+3]=255}}p.putImageData(a,e.leftPos,e.topPos),w||(T.scale(K(),K()),w=!0),S&&(T.drawImage(C,0,0),S=r.auto_play),g=e},H=function(){var e=-1,t=0,n=function(){var t=v?1:-1;return(e+t+_.length)%_.length},a=function(t){e+=t,o()},i=function(){var r=!1,i=function(){null!==A&&A(x),t++,P!==!1||t<0?o():(r=!1,y=!1)},o=function(){if(r=y){a(1);var t=10*_[e].delay;t||(t=100);var s=n();0===s?(t+=U,setTimeout(i,t)):setTimeout(o,t)}};return function(){r||setTimeout(o,0)}}(),o=function(){var t;e=parseInt(e,10),e>_.length-1&&(e=0),e<0&&(e=0),t=m[e],C.getContext(\"2d\").putImageData(_[e].data,t.x,t.y),T.globalCompositeOperation=\"copy\",T.drawImage(C,0,0)},u=function(){y=!0,i()},l=function(){y=!1};return{init:function(){s||(r.c_w&&r.c_h||T.scale(K(),K()),r.auto_play?i():(e=0,o()))},step:i,play:u,pause:l,playing:y,move_relative:a,current_frame:function(){return e},frames:function(){return _},length:function(){return _.length},move_to:function(t){e=t,o()}}}(),V=function(e){N(i.pos,i.data.length,e)},X=function(){},Z=function(e,t){return function(n){e(n),V(t)}},J=function(){var e=x.parentNode,t=document.createElement(\"div\");b=document.createElement(\"canvas\"),T=b.getContext(\"2d\"),B=document.createElement(\"div\"),C=document.createElement(\"canvas\"),t.width=b.width=x.width,t.height=b.height=x.height,B.style.minWidth=x.width+\"px\",t.className=\"jsgif\",B.className=\"jsgif_toolbar\",t.appendChild(b),t.appendChild(B),e&&(e.insertBefore(t,x),e.removeChild(x)),r.c_w&&r.c_h&&z(r.c_w,r.c_h),Q=!0},K=function(){var e;return e=r.max_width&&o&&o.width>r.max_width?r.max_width/o.width:1},Q=!1,Y=!1,$=function(e){return!u&&(Y=!!e&&e,u=!0,_=[],j(),f=null,h=null,p=null,g=null,!0)};return{play:H.play,pause:H.pause,move_relative:H.move_relative,move_to:H.move_to,get_frames:function(){return H.frames()},get_playing:function(){return y},get_canvas:function(){return b},get_canvas_scale:function(){return K()},get_loading:function(){return u},get_auto_play:function(){return r.auto_play},get_length:function(){return H.length()},get_current_frame:function(){return H.current_frame()},load_url:function(t,n){if($(n)){var r=new XMLHttpRequest;r.open(\"GET\",t,!0),\"overrideMimeType\"in r?r.overrideMimeType(\"text/plain; charset=x-user-defined\"):\"responseType\"in r?r.responseType=\"arraybuffer\":r.setRequestHeader(\"Accept-Charset\",\"x-user-defined\"),r.onloadstart=function(){Q||J()},r.onload=function(t){200!=this.status&&G(\"xhr - response\"),\"response\"in this||(this.response=new VBArray(this.responseText).toArray().map(String.fromCharCode).join(\"\"));var n=this.response;n instanceof ArrayBuffer&&(n=new Uint8Array(n)),i=new e(n),setTimeout(R,0)},r.onprogress=function(e){e.lengthComputable&&N(e.loaded,e.total,!0)},r.onerror=function(){G(\"xhr\")},r.send()}},load:function(e){this.load_url(x.getAttribute(\"data-animated-src\")||x.src,e)},load_raw:function(t,n){$(n)&&(Q||J(),i=new e(t),setTimeout(R,0))},set_frame_offset:F}};return a})},{\"./Stream.js\":1,\"./parseGIF.js\":3}]},{},[4])(4)});"],"file":"sibgif.min.js","sourceRoot":"/source/"}